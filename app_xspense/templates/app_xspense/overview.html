{% extends "app_xspense/base.html" %}
{% load staticfiles %}

{% block content %}
	{% if user.is_authenticated %}
		<!-- SHOW FLASHES -->
		{% if messages %}
		<ul class="messages">
		    {% for msg in messages %}      
		    <li>
		        <div class="alert alert-{{msg.level_tag}}" role="alert">
		    {{msg.message}}
		    </div>
		    </li>
		    {% endfor %}
		</ul>
		{% endif %}

		<!-- SHOW BUDGET/EXPENSES OVERVIEW -->
		<div id="budget-expense">
		{% for budget in budgets %}
			<div class="medium-6 large-3 columns budget">
				<div class="budgets">
				<div class="budget-info">
					<h2 class="purpose">{{ budget.purpose|title }}</h2>
					<h5 class="amount">Budget Amount: ${{ budget.amount }}</h5>
				</div>
				<div class="expense-info">
					<h3>Expenses</h3>
					{% for expense in budget.expense_set.all %}
						<div class="exspense">
							<div class="item">{{ expense.item|title }}</div>
							<div class="location">{{ expense.location|title }}</div>
							<div class="price">${{ expense.price }}</div>
						</div>
					{% endfor %}
				</div>
				</div>
				</div>
		{% endfor %}
		</div>
	{% else %}
		<!-- SHOW FLASHES -->
		{% if messages %}
		<ul class="messages">
		    {% for msg in messages %}      
		    <li>
		        <div class="alert alert-{{msg.level_tag}}" role="alert">
		    {{msg.message}}
		    </div>
		    </li>
		    {% endfor %}
		</ul>
		{% endif %}

		<!-- LANDING PORTION -->
			<!-- LANDING IMG -->
			<div class="landing small-4 large-3 columns">
				<h3>Walk more comfortably. Use xspense to track spending.</h3>
			</div>
			<hr>
		xspense landing

		<!-- LOGIN POPUP -->
		<div id="login-form" class="hidden">
		<div id="loginModal" class="modal show" tabindex="" role="dialog" aria-hidden="true">
		  <div class="modal-dialog" style="margin-top:10%">
		  <div class="modal-content">
		      <div class="modal-header">
		          <div type="button" class="loginModal_close" data-dismiss="modal" aria-hidden="true" style="cursor:pointer">x</div>
		          <h1 class="text-center">Login</h1>
		      </div>
		      <div class="modal-body">
		          <form class="form col-md-12 center-block" id="login_form" method="post" action="/login">
		            <div class="form-group">
		            {% csrf_token %}
		              <input type="text" class="form-control input-lg" placeholder="Username" name="username" value="" size="50">
		            </div>
		            <div class="form-group">
		              <input type="password" name="password" value="" size="50" class="form-control input-lg" placeholder="Password"/>
		            </div>
		            <div class="form-group">
		              <input class="btn btn-primary btn-lg btn-block" type="submit" value="Sign In" />
		              <br>
		              <span class="pull-right"><a href="register">Register</a></span><span><a href="register">Need help?</a></span>
		            </div>
		          </form>
		      </div>
		      <div class="modal-footer">  
		      </div>
		  </div>
		  </div>
		</div>
		</div>
	{% endif %}

<script src="{% static "js/jquery.popupoverlay.js" %}" type="text/javascript"></script>
<script>
  $(document).ready(function() {
  	$("div#login-form").removeClass("hidden");
    // Initialize the jquery popup overlay plugin
    $('#loginModal').popup({
    	transition: 'all 0.3s',
    });
  });
</script>

{% endblock %}